<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 18: Smoothing Methods – Chad’s Course Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../../">
<script src="../../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../../site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../../../index.html">
    <span class="navbar-title">Chad’s Course Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../Course/GE2021/03_Lecture_Note/LectureNote_Chad/PPT/chapter0/chapter0.html"> 
<span class="menu-text">test</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem-18.1-impact-of-september-11-on-air-travel-in-the-united-states" id="toc-problem-18.1-impact-of-september-11-on-air-travel-in-the-united-states" class="nav-link active" data-scroll-target="#problem-18.1-impact-of-september-11-on-air-travel-in-the-united-states">Problem 18.1: Impact of September 11 on Air Travel in the United States</a>
  <ul class="collapse">
  <li><a href="#solution-18.1.a" id="toc-solution-18.1.a" class="nav-link" data-scroll-target="#solution-18.1.a">Solution 18.1.a</a></li>
  <li><a href="#solution-18.1.b" id="toc-solution-18.1.b" class="nav-link" data-scroll-target="#solution-18.1.b">Solution 18.1.b</a></li>
  </ul></li>
  <li><a href="#problem-18.2-relation-between-moving-average-and-exponential-smoothing" id="toc-problem-18.2-relation-between-moving-average-and-exponential-smoothing" class="nav-link" data-scroll-target="#problem-18.2-relation-between-moving-average-and-exponential-smoothing">Problem 18.2: Relation Between Moving Average and Exponential Smoothing</a></li>
  <li><a href="#problem-18.3-forecasting-with-a-moving-average" id="toc-problem-18.3-forecasting-with-a-moving-average" class="nav-link" data-scroll-target="#problem-18.3-forecasting-with-a-moving-average">Problem 18.3: Forecasting with a Moving Average</a>
  <ul class="collapse">
  <li><a href="#solution-18.3.a" id="toc-solution-18.3.a" class="nav-link" data-scroll-target="#solution-18.3.a">Solution 18.3.a</a></li>
  <li><a href="#solution-18.3.b" id="toc-solution-18.3.b" class="nav-link" data-scroll-target="#solution-18.3.b">Solution 18.3.b</a></li>
  </ul></li>
  <li><a href="#problem-18.4-optimizing-holtwinters-exponential-smoothing" id="toc-problem-18.4-optimizing-holtwinters-exponential-smoothing" class="nav-link" data-scroll-target="#problem-18.4-optimizing-holtwinters-exponential-smoothing">Problem 18.4: Optimizing Holt–Winter’s Exponential Smoothing</a>
  <ul class="collapse">
  <li><a href="#solution-18.4.a" id="toc-solution-18.4.a" class="nav-link" data-scroll-target="#solution-18.4.a">Solution 18.4.a</a></li>
  <li><a href="#solution-18.4.b" id="toc-solution-18.4.b" class="nav-link" data-scroll-target="#solution-18.4.b">Solution 18.4.b</a></li>
  </ul></li>
  <li><a href="#problem-18.5-department-store-sales" id="toc-problem-18.5-department-store-sales" class="nav-link" data-scroll-target="#problem-18.5-department-store-sales">Problem 18.5: Department Store Sales</a>
  <ul class="collapse">
  <li><a href="#solution-18.5.a" id="toc-solution-18.5.a" class="nav-link" data-scroll-target="#solution-18.5.a">Solution 18.5.a</a></li>
  <li><a href="#solution-18.5.b" id="toc-solution-18.5.b" class="nav-link" data-scroll-target="#solution-18.5.b">Solution 18.5.b</a></li>
  <li><a href="#solution-18.5.b.i" id="toc-solution-18.5.b.i" class="nav-link" data-scroll-target="#solution-18.5.b.i">Solution 18.5.b.i</a></li>
  <li><a href="#solution-18.5.b.ii" id="toc-solution-18.5.b.ii" class="nav-link" data-scroll-target="#solution-18.5.b.ii">Solution 18.5.b.ii</a></li>
  <li><a href="#solution-18.5.c" id="toc-solution-18.5.c" class="nav-link" data-scroll-target="#solution-18.5.c">Solution 18.5.c</a></li>
  </ul></li>
  <li><a href="#problem-18.6-shipments-of-household-appliances" id="toc-problem-18.6-shipments-of-household-appliances" class="nav-link" data-scroll-target="#problem-18.6-shipments-of-household-appliances">Problem 18.6: Shipments of Household Appliances</a>
  <ul class="collapse">
  <li><a href="#solution-18.6.a" id="toc-solution-18.6.a" class="nav-link" data-scroll-target="#solution-18.6.a">Solution 18.6.a</a></li>
  <li><a href="#solution-18.6.b" id="toc-solution-18.6.b" class="nav-link" data-scroll-target="#solution-18.6.b">Solution 18.6.b</a>
  <ul class="collapse">
  <li><a href="#solution-18.6.b.i" id="toc-solution-18.6.b.i" class="nav-link" data-scroll-target="#solution-18.6.b.i">Solution 18.6.b.i</a></li>
  <li><a href="#solution-18.6.b.ii" id="toc-solution-18.6.b.ii" class="nav-link" data-scroll-target="#solution-18.6.b.ii">Solution 18.6.b.ii</a></li>
  <li><a href="#solution-18.6.b.iii" id="toc-solution-18.6.b.iii" class="nav-link" data-scroll-target="#solution-18.6.b.iii">Solution 18.6.b.iii</a></li>
  <li><a href="#solution-18.6.b.iv" id="toc-solution-18.6.b.iv" class="nav-link" data-scroll-target="#solution-18.6.b.iv">Solution 18.6.b.iv</a></li>
  <li><a href="#solution-18.6.b.v" id="toc-solution-18.6.b.v" class="nav-link" data-scroll-target="#solution-18.6.b.v">Solution 18.6.b.v</a></li>
  </ul></li>
  <li><a href="#solution-18.6.c" id="toc-solution-18.6.c" class="nav-link" data-scroll-target="#solution-18.6.c">Solution 18.6.c</a>
  <ul class="collapse">
  <li><a href="#solution-18.6.c.i" id="toc-solution-18.6.c.i" class="nav-link" data-scroll-target="#solution-18.6.c.i">Solution 18.6.c.i</a></li>
  <li><a href="#solution-18.6.c.ii" id="toc-solution-18.6.c.ii" class="nav-link" data-scroll-target="#solution-18.6.c.ii">Solution 18.6.c.ii</a></li>
  <li><a href="#solution-18.6.c.iii" id="toc-solution-18.6.c.iii" class="nav-link" data-scroll-target="#solution-18.6.c.iii">Solution 18.6.c.iii</a></li>
  <li><a href="#solution-18.6.c.iv" id="toc-solution-18.6.c.iv" class="nav-link" data-scroll-target="#solution-18.6.c.iv">Solution 18.6.c.iv</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#problem-18.7-shampoo-sales" id="toc-problem-18.7-shampoo-sales" class="nav-link" data-scroll-target="#problem-18.7-shampoo-sales">Problem 18.7: Shampoo Sales</a></li>
  <li><a href="#problem-18.8-natural-gas-sales" id="toc-problem-18.8-natural-gas-sales" class="nav-link" data-scroll-target="#problem-18.8-natural-gas-sales">Problem 18.8: Natural Gas Sales</a>
  <ul class="collapse">
  <li><a href="#solution-18.8.a" id="toc-solution-18.8.a" class="nav-link" data-scroll-target="#solution-18.8.a">Solution 18.8.a</a></li>
  <li><a href="#solution-18.8.b" id="toc-solution-18.8.b" class="nav-link" data-scroll-target="#solution-18.8.b">Solution 18.8.b</a></li>
  <li><a href="#solution-18.8.c" id="toc-solution-18.8.c" class="nav-link" data-scroll-target="#solution-18.8.c">Solution 18.8.c</a></li>
  </ul></li>
  <li><a href="#problem-18.9-australian-wine-sales" id="toc-problem-18.9-australian-wine-sales" class="nav-link" data-scroll-target="#problem-18.9-australian-wine-sales">Problem 18.9: Australian Wine Sales</a>
  <ul class="collapse">
  <li><a href="#solution-18.9.a" id="toc-solution-18.9.a" class="nav-link" data-scroll-target="#solution-18.9.a">Solution 18.9.a</a></li>
  <li><a href="#solution-18.9.b" id="toc-solution-18.9.b" class="nav-link" data-scroll-target="#solution-18.9.b">Solution 18.9.b</a></li>
  <li><a href="#solution-18.9.c" id="toc-solution-18.9.c" class="nav-link" data-scroll-target="#solution-18.9.c">Solution 18.9.c</a>
  <ul class="collapse">
  <li><a href="#solution-18.9.c.i" id="toc-solution-18.9.c.i" class="nav-link" data-scroll-target="#solution-18.9.c.i">Solution 18.9.c.i</a></li>
  <li><a href="#solution-18.9.c.i-1" id="toc-solution-18.9.c.i-1" class="nav-link" data-scroll-target="#solution-18.9.c.i-1">Solution 18.9.c.i</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 18: Smoothing Methods</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<ol start="3" type="a">
<li>2019-2020 Galit Shmueli, Peter C. Bruce, Peter Gedeck</li>
</ol>
<p><em>Data Mining for Business Analytics: Concepts, Techniques, and Applications in Python</em> (First Edition) Galit Shmueli, Peter C. Bruce, Peter Gedeck, and Nitin R. Patel. 2019.</p>
<p>Date: 2020-03-08</p>
<p>Python Version: 3.8.2 Jupyter Notebook Version: 5.6.1</p>
<p>Packages: - dmba: 0.0.12 - matplotlib: 3.2.0 - numpy: 1.18.1 - pandas: 1.0.1 - statsmodels: 0.11.1</p>
<p>The assistance from Mr.&nbsp;Kuber Deokar and Ms.&nbsp;Anuja Kulkarni in preparing these solutions is gratefully acknowledged.</p>
</blockquote>
<div id="cell-3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import required packages for this chapter</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> sm</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa <span class="im">import</span> tsatools</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.graphics <span class="im">import</span> tsaplots</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tsa.holtwinters <span class="im">import</span> ExponentialSmoothing</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dmba <span class="im">import</span> regressionSummary</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Working directory:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We assume that data are kept in the same directory as the notebook. If you keep your </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># data in a different folder, replace the argument of the `Path`</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>DATA <span class="op">=</span> Path(<span class="st">'.'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and then load data using </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.read_csv(DATA / ‘filename.csv’)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="problem-18.1-impact-of-september-11-on-air-travel-in-the-united-states" class="level1">
<h1>Problem 18.1: Impact of September 11 on Air Travel in the United States</h1>
<p>The Research and Innovative Technology Administration’s Bureau of Transportation Statistics conducted a study to evaluate the impact of the September 11, 2001 terrorist attack on US transportation. The 2006 study report and the data can be found at https://www.bts.gov/archive/publications/estimated_impacts_of_9_11_on_us_travel/index. The goal of the study was stated as follows:</p>
<blockquote class="blockquote">
<p>The purpose of this study is to provide a greater understanding of the passenger travel behavior patterns of persons making long distance trips before and after 9/11.</p>
</blockquote>
<p>The report analyzes monthly passenger movement data between January 1990 and May 2004. Data on three monthly time series are given in file <em>Sept11Travel.csv</em> for this period: (1) Actual airline revenue passenger miles (Air), (2) Rail passenger miles (Rail), and (3) Vehicle miles traveled (Car).</p>
<p>In order to assess the impact of September 11, BTS took the following approach: using data before September 11, they forecasted future data (under the assumption of no terrorist attack). Then, they compared the forecasted series with the actual data to assess the impact of the event. Our first step, therefore, is to split each of the time series into two parts: pre- and post-September 11. We now concentrate only on the earlier time series.</p>
<section id="solution-18.1.a" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.1.a">Solution 18.1.a</h2>
<p>Create a time plot for the pre-event AIR time series. What time series components appear from the plot?</p>
<div id="cell-6" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(DATA <span class="op">/</span> <span class="st">'Sept11Travel.csv'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(df.Month, <span class="bu">format</span><span class="op">=</span><span class="st">'%b-%y'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>air_ts <span class="op">=</span> pd.Series(df[<span class="st">'Air RPM (000s)'</span>].values, index<span class="op">=</span>df.Date, name<span class="op">=</span><span class="st">'Air'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>rail_ts <span class="op">=</span> pd.Series(df[<span class="st">'Rail PM'</span>].values, index<span class="op">=</span>df.Date, name<span class="op">=</span><span class="st">'Rail'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>car_ts <span class="op">=</span> pd.Series(df[<span class="st">'VMT (billions)'</span>].values, index<span class="op">=</span>df.Date, name<span class="op">=</span><span class="st">'Car'</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>pre_air_ts <span class="op">=</span> air_ts[:<span class="st">'2001-01-01'</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>pre_air_ts.plot()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solution-18.1.b" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.1.b">Solution 18.1.b</h2>
<p>The Figure in the book shows a time plot of the <strong>seasonally adjusted</strong> pre-September-11 AIR series. Which of the following smoothing methods would be adequate for forecasting this series?</p>
<ul>
<li><p>Moving average (with what window width?)</p></li>
<li><p>Simple exponential smoothing</p></li>
<li><p>Holt exponential smoothing</p></li>
<li><p>Holt–Winter’s exponential smoothing</p></li>
<li><p>Moving average (with what window width?) - NO</p></li>
<li><p>Simple exponential smoothing - NO</p></li>
<li><p>Holt exponential smoothing - YES (also called double exponential smoothing - used when a trend is present)</p></li>
<li><p>Holt-Winter’s exponential smoothing - NO (Holt-Winters is used when trend and seasonality are present, but the seasonality has already been removed from this series)</p></li>
</ul>
</section>
</section>
<section id="problem-18.2-relation-between-moving-average-and-exponential-smoothing" class="level1">
<h1>Problem 18.2: Relation Between Moving Average and Exponential Smoothing</h1>
<p>Assume that we apply a moving average to a series, using a very short window span. If we wanted to achieve an equivalent result using simple exponential smoothing, what value should the smoothing coefficient take?</p>
<p>The coefficient should be a relatively high value. For example, a value of 0.5 would attach a weight of only <span class="math inline">\((0.5)^3\)</span> or 12.5% to the t-3 time period, and lesser weights to earlier periods.</p>
</section>
<section id="problem-18.3-forecasting-with-a-moving-average" class="level1">
<h1>Problem 18.3: Forecasting with a Moving Average</h1>
<p>For a given time series of sales, the training set consists of 50 months. The first 5 months’ data are shown below:</p>
<pre><code>Sep 98: 27
Oct 98: 31
Nov 98: 58
Dec 98: 63
Jan 99: 59</code></pre>
<section id="solution-18.3.a" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.3.a">Solution 18.3.a</h2>
<p>Compute the sales forecast for January 1999 based on a moving average with <span class="math inline">\(w = 4\)</span>.</p>
</section>
<section id="solution-18.3.b" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.3.b">Solution 18.3.b</h2>
<p>Compute the forecast error for the above forecast.</p>
<div id="cell-10" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Sales <span class="op">=</span> [<span class="dv">27</span>, <span class="dv">31</span>, <span class="dv">58</span>, <span class="dv">63</span>, <span class="dv">59</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>forecast <span class="op">=</span> <span class="bu">sum</span>(Sales[<span class="dv">0</span>:<span class="dv">4</span>]) <span class="op">/</span> <span class="dv">4</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'18.3a) Forecast '</span>, forecast)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'18.3b) Forecast error '</span>, Sales[<span class="dv">4</span>] <span class="op">-</span> forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>18.3a) Forecast  44.75
18.3b) Forecast error  14.25</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sales <span class="op">=</span> pd.Series(Sales)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>movingAverage <span class="op">=</span> sales.rolling(<span class="dv">4</span>).mean()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>forecast <span class="op">=</span> movingAverage[<span class="dv">3</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'18.3a) Forecast '</span>, forecast)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'18.3b) Forecast error '</span>, sales[<span class="dv">4</span>] <span class="op">-</span> forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>18.3a) Forecast  44.75
18.3b) Forecast error  14.25</code></pre>
</div>
</div>
</section>
</section>
<section id="problem-18.4-optimizing-holtwinters-exponential-smoothing" class="level1">
<h1>Problem 18.4: Optimizing Holt–Winter’s Exponential Smoothing</h1>
<p>The table below shows the optimal smoothing constants from applying exponential smoothing to data, using automated model selection:</p>
<pre><code> Level         1.000
 Trend         0.000
 Seasonality   0.246</code></pre>
<section id="solution-18.4.a" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.4.a">Solution 18.4.a</h2>
<p>The value of zero that is obtained for the trend smoothing constant means that (choose one of the following):</p>
<ul>
<li><p>There is no trend.</p></li>
<li><p>The trend is estimated only from the first two periods.</p></li>
<li><p>The trend is updated throughout the data.</p></li>
<li><p>The trend is statistically insignificant.</p></li>
<li><p>There is no trend. - NO</p></li>
<li><p>The trend is estimated only from the first two periods. - YES</p></li>
<li><p>The trend is updated throughout the data. - NO</p></li>
<li><p>The trend is statistically insignificant. - YES</p></li>
</ul>
</section>
<section id="solution-18.4.b" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.4.b">Solution 18.4.b</h2>
<p>What is the danger of using the optimal smoothing constant values?</p>
<p>Overfitting</p>
</section>
</section>
<section id="problem-18.5-department-store-sales" class="level1">
<h1>Problem 18.5: Department Store Sales</h1>
<p>The time plot in the Figure describes actual quarterly sales for a department store over a 6-year period (data are available in <em>DepartmentStoreSales.csv</em>, data courtesy of Chris Albright).</p>
<div id="cell-14" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(DATA <span class="op">/</span> <span class="st">'DepartmentStoreSales.csv'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_ts <span class="op">=</span> pd.Series(df[<span class="st">'Sales'</span>].values, index<span class="op">=</span>df.Quarter, name<span class="op">=</span><span class="st">'Sales'</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df_ts.plot(style<span class="op">=</span><span class="st">'.-'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Sales'</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="solution-18.5.a" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.5.a">Solution 18.5.a</h2>
<p>Which of the following methods would <strong>not</strong> be suitable for forecasting this series?</p>
<ul>
<li>Moving average of raw series - Would not be suitable</li>
<li>Moving average of deseasonalized series - Would not be suitable</li>
<li>Simple exponential smoothing of the raw series - Would not be suitable</li>
<li>Double exponential smoothing of the raw series - Would not be suitable</li>
<li>Holt–Winter’s exponential smoothing of the raw series</li>
<li>Regression model fit to the raw series</li>
<li>Random walk model fit to the raw series - Would not be suitable</li>
</ul>
</section>
<section id="solution-18.5.b" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.5.b">Solution 18.5.b</h2>
<p>The forecaster was tasked to generate forecasts for 4 quarters ahead. He therefore partitioned the data such that the last 4 quarters were designated as the validation period. The forecaster approached the forecasting task by using multiplicative Holt-Winter’s exponential smoothing. The smoothing parameters used were <span class="math inline">\(\alpha=0.2, \beta=0.15, \gamma=0.05\)</span>.</p>
</section>
<section id="solution-18.5.b.i" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.5.b.i">Solution 18.5.b.i</h2>
<p>Run this method on the data.</p>
<div id="cell-16" class="cell" data-scrolled="false" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run exponential smoothing with additive trend and multiplicative seasonal</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>expSmooth <span class="op">=</span> ExponentialSmoothing(df_ts[:<span class="dv">20</span>], trend<span class="op">=</span><span class="st">'additive'</span>, seasonal<span class="op">=</span><span class="st">'multiplicative'</span>, seasonal_periods<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>expSmoothFit <span class="op">=</span> expSmooth.fit(smoothing_level<span class="op">=</span><span class="fl">0.2</span>, smoothing_slope<span class="op">=</span><span class="fl">0.15</span>, smoothing_seasonal<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df_ts[:<span class="dv">20</span>].plot(color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>df_ts[<span class="dv">20</span>:].plot(ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>expSmoothFit.fittedvalues.plot(ax<span class="op">=</span>ax)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>forecast <span class="op">=</span> pd.DataFrame({</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Quarter'</span>: df_ts[<span class="dv">20</span>:].index.values, </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Actual'</span>: df_ts[<span class="dv">20</span>:],</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Forecast'</span>: expSmoothFit.forecast(<span class="bu">len</span>(df_ts[<span class="dv">20</span>:])).values</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>forecast[<span class="st">'Error'</span>] <span class="op">=</span> forecast[<span class="st">'Actual'</span>] <span class="op">-</span> forecast[<span class="st">'Forecast'</span>]</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>forecast[<span class="st">'mape'</span>] <span class="op">=</span> np.<span class="bu">abs</span>(forecast[<span class="st">'Error'</span>]) <span class="op">/</span> np.<span class="bu">abs</span>(forecast[<span class="st">'Actual'</span>])</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>forecast.plot(y<span class="op">=</span><span class="st">'Forecast'</span>, ax<span class="op">=</span>ax, style<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>forecast</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># warning expected</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/gedeck/opt/anaconda3/envs/dmba-notebooks/lib/python3.8/site-packages/statsmodels/tsa/base/tsa_model.py:213: ValueWarning: An unsupported index was provided and will be ignored when e.g. forecasting.
  warnings.warn('An unsupported index was provided and will be'
/Users/gedeck/opt/anaconda3/envs/dmba-notebooks/lib/python3.8/site-packages/statsmodels/tsa/base/tsa_model.py:580: ValueWarning: No supported index is available. Prediction results will be given with an integer index beginning at `start`.
  warnings.warn('No supported index is available.'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Quarter</th>
<th data-quarto-table-cell-role="th">Actual</th>
<th data-quarto-table-cell-role="th">Forecast</th>
<th data-quarto-table-cell-role="th">Error</th>
<th data-quarto-table-cell-role="th">mape</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Quarter</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>21</td>
<td>60800</td>
<td>58940.902683</td>
<td>1859.097317</td>
<td>0.030577</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>22</td>
<td>64900</td>
<td>61416.610944</td>
<td>3483.389056</td>
<td>0.053673</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23</td>
<td>23</td>
<td>76997</td>
<td>72077.383125</td>
<td>4919.616875</td>
<td>0.063894</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24</td>
<td>24</td>
<td>103337</td>
<td>95804.447363</td>
<td>7532.552637</td>
<td>0.072893</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-8-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solution-18.5.b.ii" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.5.b.ii">Solution 18.5.b.ii</h2>
<p>The forecasts for the validation set are given above. Compute the MAPE values for the forecasts of quarters 21 and 22.</p>
<div id="cell-18" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>regressionSummary(df_ts[<span class="dv">20</span>:<span class="dv">22</span>].values, forecast[<span class="st">'Forecast'</span>].values[:<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression statistics

                      Mean Error (ME) : 2671.2432
       Root Mean Squared Error (RMSE) : 2791.9744
            Mean Absolute Error (MAE) : 2671.2432
          Mean Percentage Error (MPE) : 4.2125
Mean Absolute Percentage Error (MAPE) : 4.2125</code></pre>
</div>
</div>
</section>
<section id="solution-18.5.c" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.5.c">Solution 18.5.c</h2>
<p>The fit and residuals from the exponential smoothing are shown in the next Figure. Using all the information thus far, is this model suitable for forecasting quarters 21 and 22?</p>
<div id="cell-20" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> warnings.catch_warnings():</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    warnings.simplefilter(<span class="st">"ignore"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> df_ts[:<span class="dv">20</span>].plot(ax<span class="op">=</span>axes[<span class="dv">0</span>], color<span class="op">=</span><span class="st">'C0'</span>, style<span class="op">=</span><span class="st">'.-'</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    expSmoothFit.fittedvalues.plot(ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'C1'</span>, style<span class="op">=</span><span class="st">'.-'</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Sales ($)'</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'Exp. Smoothing: Actual Vs. Forecast (Training Data)'</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_ticks(np.arange(<span class="dv">1</span>, <span class="dv">21</span>, <span class="dv">2</span>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    residuals <span class="op">=</span> df_ts[:<span class="dv">20</span>] <span class="op">-</span> expSmoothFit.fittedvalues</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> residuals.plot(ax<span class="op">=</span>axes[<span class="dv">1</span>], color<span class="op">=</span><span class="st">'C1'</span>, style<span class="op">=</span><span class="st">'.-'</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">'Forecast Error'</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">'Exp. Smoothing Forecast Errors (Training Data)'</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_ticks(np.arange(<span class="dv">1</span>, <span class="dv">21</span>, <span class="dv">2</span>))</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>From the plots we can see that the actual and forecasted values in periods 21-22 match well in Holt Winter’s exponential smoothing; better than in the regression model. The MAPE for Holt Winter’s exponential smoothing (4.21%) is also lower than the MAPE for the regression model (4.69%, see Problem 17.5). This implies that the more suitable model for forecasting quarters 21 and 22 is Holt Winter’s exponential smoothing. However, there could be other practical reasons that would make the regression model preferable.</p>
</section>
</section>
<section id="problem-18.6-shipments-of-household-appliances" class="level1">
<h1>Problem 18.6: Shipments of Household Appliances</h1>
<p>The time plot in the Figure shows the series of quarterly shipments (in million dollars) of US household appliances between 1985–1989 (data are available in <em>ApplianceShipments.csv</em>, data courtesy of Ken Black).</p>
<div id="cell-23" class="cell" data-scrolled="false" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(DATA <span class="op">/</span> <span class="st">'ApplianceShipments.csv'</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df [[<span class="st">'Quarter'</span>, <span class="st">'Shipments'</span>]]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert Quarter information into month-year</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> q, m <span class="kw">in</span> (<span class="st">'Q1'</span>, <span class="st">'03'</span>), (<span class="st">'Q2'</span>, <span class="st">'06'</span>), (<span class="st">'Q3'</span>, <span class="st">'09'</span>), (<span class="st">'Q4'</span>, <span class="st">'12'</span>):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Quarter'</span>] <span class="op">=</span> df[<span class="st">'Quarter'</span>].<span class="bu">str</span>.replace(q, m)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Quarter'</span>] <span class="op">=</span> pd.to_datetime(df.Quarter, <span class="bu">format</span><span class="op">=</span><span class="st">'%m-%Y'</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>df_ts <span class="op">=</span> pd.Series(df[<span class="st">'Shipments'</span>].values, index<span class="op">=</span>df.Quarter, name<span class="op">=</span><span class="st">'shipments'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>df_ts.index <span class="op">=</span> df_ts.index.to_period(<span class="st">"Q"</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df_ts.plot(style<span class="op">=</span><span class="st">'.-'</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">3</span>))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Shipments (in 000$)'</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="solution-18.6.a" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.6.a">Solution 18.6.a</h2>
<p>Which of the following methods would be suitable for forecasting this series if applied to the raw data?</p>
<ul>
<li>Moving average - NO</li>
<li>Simple exponential smoothing - NO</li>
<li>Double exponential smoothing - NO</li>
<li>Holt–Winter’s exponential smoothing -YES</li>
</ul>
</section>
<section id="solution-18.6.b" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.6.b">Solution 18.6.b</h2>
<p>Apply a moving average with window span <span class="math inline">\(w=4\)</span> to the data. Use all but the last year as the training set. Create a time plot of the moving average series.</p>
<div id="cell-25" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df_ts.plot(x<span class="op">=</span><span class="st">'Quarter'</span>, y<span class="op">=</span><span class="st">'Shipments'</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ma_trailing <span class="op">=</span> df_ts[:<span class="op">-</span><span class="dv">4</span>].rolling(<span class="dv">4</span>).mean()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>ma_trailing <span class="op">=</span> pd.Series(ma_trailing[:<span class="op">-</span><span class="dv">1</span>].values, index<span class="op">=</span>ma_trailing.index[<span class="dv">1</span>:])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>ma_trailing.plot(ax<span class="op">=</span>ax)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>df_ts[<span class="op">-</span><span class="dv">4</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Quarter
1989Q1    4245
1989Q2    4900
1989Q3    4585
1989Q4    4533
Freq: Q-DEC, Name: shipments, dtype: int64</code></pre>
</div>
</div>
<section id="solution-18.6.b.i" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.b.i">Solution 18.6.b.i</h3>
<p>What does the MA(4) chart reveal?</p>
<p>There is an increasing trend until 1987, then a slight decreasing trend, with a final stabilization.</p>
</section>
<section id="solution-18.6.b.ii" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.b.ii">Solution 18.6.b.ii</h3>
<p>Use the MA(4) model to forecast appliance sales in Q1-1990.</p>
</section>
<section id="solution-18.6.b.iii" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.b.iii">Solution 18.6.b.iii</h3>
<p>Use the MA(4) model to forecast appliance sales in Q1-1991.</p>
<div id="cell-27" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ma_trailing_full <span class="op">=</span> df_ts.rolling(<span class="dv">4</span>).mean()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'forecast Q1-1990: </span><span class="sc">{</span>ma_trailing_full[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'forecast Q1-1991: same as stable trend </span><span class="sc">{</span>ma_trailing_full[<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>forecast Q1-1990: 4565.75
forecast Q1-1991: same as stable trend 4565.75</code></pre>
</div>
</div>
</section>
<section id="solution-18.6.b.iv" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.b.iv">Solution 18.6.b.iv</h3>
<p>Is the forecast for Q1-1990 most likely to under-estimate, over-estimate or accurately estimate the actual sales on Q1-1990? Explain.</p>
<p>It should be fairly accurate - the recent trend is stable, and Q1 values have been close to trend in the past.</p>
</section>
<section id="solution-18.6.b.v" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.b.v">Solution 18.6.b.v</h3>
<p>Management feels most comfortable with moving averages. The analyst therefore plans to use this method for forecasting future quarters. What else should be considered before using the MA(4) to forecast future quarterly shipments of household appliances?</p>
<p>Seasonal adjustment</p>
</section>
</section>
<section id="solution-18.6.c" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.6.c">Solution 18.6.c</h2>
<p>We now focus on forecasting beyond 1989. In the following, continue to use all but the last year as the training set, and the last four quarters as the validation set. First, fit a regression model to sales with a linear trend and quarterly seasonality to the training data. Next, apply Holt–Winter’s exponential smoothing with smoothing parameters <span class="math inline">\(\alpha=0.2, \beta=0.15, \gamma=0.05\)</span> to the training data. Choose an adequate ‘season length.’</p>
<p>Regression model</p>
<div id="cell-30" class="cell" data-scrolled="false" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_lm <span class="op">=</span> tsatools.add_trend(pd.Series(df.Shipments.values, index<span class="op">=</span>df.Quarter, name<span class="op">=</span><span class="st">'Sales'</span>), trend<span class="op">=</span><span class="st">'ct'</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_lm[<span class="st">'Qtr'</span>] <span class="op">=</span> df_lm.index.quarter</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>modelA <span class="op">=</span> sm.ols(formula<span class="op">=</span><span class="st">'Sales ~ trend + C(Qtr)'</span>, data<span class="op">=</span>df_lm[:<span class="op">-</span><span class="dv">4</span>]).fit()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># warning expected</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modelA.summary())</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df_ts[:<span class="op">-</span><span class="dv">4</span>].plot(color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>df_ts[<span class="op">-</span><span class="dv">4</span>:].plot(ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>modelA.fittedvalues.plot(ax<span class="op">=</span>ax)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>modelA.predict(df_lm[<span class="op">-</span><span class="dv">4</span>:]).plot(ax<span class="op">=</span>ax, style<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  Sales   R-squared:                       0.749
Model:                            OLS   Adj. R-squared:                  0.658
Method:                 Least Squares   F-statistic:                     8.208
Date:                Sun, 08 Mar 2020   Prob (F-statistic):            0.00255
Time:                        20:21:23   Log-Likelihood:                -100.84
No. Observations:                  16   AIC:                             211.7
Df Residuals:                      11   BIC:                             215.5
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
===============================================================================
                  coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------
Intercept    4054.9250    101.132     40.095      0.000    3832.336    4277.514
C(Qtr)[T.2]   271.2750    112.981      2.401      0.035      22.605     519.945
C(Qtr)[T.3]    85.8000    114.029      0.752      0.468    -165.176     336.776
C(Qtr)[T.4]  -232.9250    115.754     -2.012      0.069    -487.698      21.848
trend          35.7250      8.904      4.012      0.002      16.127      55.323
==============================================================================
Omnibus:                        0.690   Durbin-Watson:                   1.504
Prob(Omnibus):                  0.708   Jarque-Bera (JB):                0.345
Skew:                           0.345   Prob(JB):                        0.841
Kurtosis:                       2.799   Cond. No.                         42.5
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/gedeck/opt/anaconda3/envs/dmba-notebooks/lib/python3.8/site-packages/scipy/stats/stats.py:1534: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=16
  warnings.warn("kurtosistest only valid for n&gt;=20 ... continuing "</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-14-output-3.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-31" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>regressionSummary(df_lm[:<span class="op">-</span><span class="dv">4</span>].Sales, modelA.fittedvalues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression statistics

                      Mean Error (ME) : -0.0000
       Root Mean Squared Error (RMSE) : 132.0699
            Mean Absolute Error (MAE) : 104.0688
          Mean Percentage Error (MPE) : -0.0906
Mean Absolute Percentage Error (MAPE) : 2.3544</code></pre>
</div>
</div>
<section id="solution-18.6.c.i" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.c.i">Solution 18.6.c.i</h3>
<p>Compute the MAPE for the validation data using the regression model.</p>
<div id="cell-33" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>regressionSummary(df_lm[<span class="op">-</span><span class="dv">4</span>:].Sales, modelA.predict(df_lm[<span class="op">-</span><span class="dv">4</span>:]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression statistics

                      Mean Error (ME) : -181.1250
       Root Mean Squared Error (RMSE) : 241.8138
            Mean Absolute Error (MAE) : 181.1250
          Mean Percentage Error (MPE) : -4.1085
Mean Absolute Percentage Error (MAPE) : 4.1085</code></pre>
</div>
</div>
</section>
<section id="solution-18.6.c.ii" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.c.ii">Solution 18.6.c.ii</h3>
<p>Compute the MAPE for the validation data using Holt-Winter’s exponential smoothing.</p>
<div id="cell-35" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>expSmooth <span class="op">=</span> ExponentialSmoothing(df_ts[:<span class="op">-</span><span class="dv">4</span>], trend<span class="op">=</span><span class="st">'additive'</span>, seasonal<span class="op">=</span><span class="st">'additive'</span>, seasonal_periods<span class="op">=</span><span class="dv">4</span>, freq<span class="op">=</span><span class="st">'Q'</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>expSmoothFit <span class="op">=</span> expSmooth.fit()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df_ts[:<span class="op">-</span><span class="dv">4</span>].plot(color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>df_ts[<span class="op">-</span><span class="dv">4</span>:].plot(ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>expSmoothFit.fittedvalues.plot(ax<span class="op">=</span>ax)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>expSmoothFit.forecast(<span class="dv">4</span>).plot(ax<span class="op">=</span>ax, style<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>regressionSummary(df_lm[<span class="op">-</span><span class="dv">4</span>:].Sales, expSmoothFit.forecast(<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression statistics

                      Mean Error (ME) : -71.9849
       Root Mean Squared Error (RMSE) : 175.6162
            Mean Absolute Error (MAE) : 144.7682
          Mean Percentage Error (MPE) : -1.7119
Mean Absolute Percentage Error (MAPE) : 3.2845</code></pre>
</div>
</div>
</section>
<section id="solution-18.6.c.iii" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.c.iii">Solution 18.6.c.iii</h3>
<p>Which model would you prefer to use for forecasting Q1-1990? Give three reasons.</p>
<p>Regression: simplicity, low MAPE on the validation data, small residuals.</p>
<p>Holt-Winter’s exponential smoothing shows only a very small improvment over regression #also does not show large improvement over Regression, is not as simple.</p>
</section>
<section id="solution-18.6.c.iv" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.6.c.iv">Solution 18.6.c.iv</h3>
<p>If we optimize the smoothing parameters in the Holt-Winter’s method, is it likely to get values that are close to zero? Why or why not?</p>
<p>Yes. It appears that both the regression and HW models yield very similar results, and therefore there is probably a global trend/seasonality going on. The Holt-Winter’s model would be able to capture this at the start and then would not need to update anymore.</p>
</section>
</section>
</section>
<section id="problem-18.7-shampoo-sales" class="level1">
<h1>Problem 18.7: Shampoo Sales</h1>
<p>The time plot in Figure 18.10 describes monthly sales of a certain shampoo over a 3-year period. [Data are available in <em>ShampooSales.csv</em>, Source: Hyndman and Yang (2018).</p>
<p>Which of the following methods would be suitable for forecasting this series if applied to the raw data?</p>
<ul>
<li>Moving average</li>
<li>Simple exponential smoothing</li>
<li>Double exponential smoothing</li>
<li>Holt-Winter’s exponential smoothing</li>
</ul>
<p>Double exponential smoothing is correct - the series shows a trend, but no apparent seasonality (which makes sense; monthly sales of shampoo could vary with sales or promotions but should not differ systematically by month or quarter)</p>
<div id="cell-39" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(DATA <span class="op">/</span> <span class="st">'ShampooSales.csv'</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df_ts <span class="op">=</span> pd.Series(df[<span class="st">'Shampoo Sales'</span>].values, index<span class="op">=</span>pd.to_datetime(df.Month, <span class="bu">format</span><span class="op">=</span><span class="st">'%b-%y'</span>), name<span class="op">=</span><span class="st">'souvenir'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df_ts.plot(style<span class="op">=</span><span class="st">'.-'</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Time'</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Units (in 000s)'</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="problem-18.8-natural-gas-sales" class="level1">
<h1>Problem 18.8: Natural Gas Sales</h1>
<p>Figure 18.11 is a time plot of quarterly natural gas sales (in billions of BTU) of a certain company, over a period of 4 years (data courtesy of George McCabe). The company’s analyst is asked to use a moving average to forecast sales in Winter 2005.</p>
<section id="solution-18.8.a" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.8.a">Solution 18.8.a</h2>
<p>Reproduce the time plot with the overlaying MA(4) line.</p>
<div id="cell-41" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(DATA <span class="op">/</span> <span class="st">'NaturalGasSales.csv'</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df.plot(x<span class="op">=</span><span class="st">'Quarter'</span>, y<span class="op">=</span><span class="st">'Gas Sales'</span>, style<span class="op">=</span><span class="st">'.-'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>ma_trailing <span class="op">=</span> df[<span class="st">'Gas Sales'</span>].rolling(<span class="dv">4</span>).mean()</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ma_trailing.plot(ax<span class="op">=</span>ax)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>ax.legend([<span class="st">"Gas Sales"</span>, <span class="st">"4 per. Mov. Avg. (Gas Sales)"</span>])<span class="op">;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Season'</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Billion BTU'</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels([<span class="st">''</span>, <span class="st">'Summer-2001'</span>, <span class="st">''</span>, <span class="st">'Summer-2002'</span>, <span class="st">''</span>, <span class="st">'Summer-2003'</span>, <span class="st">''</span>, <span class="st">'Summer-2004'</span>])</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solution-18.8.b" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.8.b">Solution 18.8.b</h2>
<p>What can we learn about the series from the MA line?</p>
<p>Sales are on a declining trend.</p>
</section>
<section id="solution-18.8.c" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.8.c">Solution 18.8.c</h2>
<p>Run a moving average forecaster with adequate season length. Are forecasts generated by this method expected to over-forecast, under-forecast, or accurately forecast actual sales? Why?</p>
<div id="cell-43" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Forecast sales: '</span>, ma_trailing.iloc[<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Forecast sales:  143.25</code></pre>
</div>
</div>
<p>Because of the declining trend, a simple moving average will tend to overestimate future sales.</p>
</section>
</section>
<section id="problem-18.9-australian-wine-sales" class="level1">
<h1>Problem 18.9: Australian Wine Sales</h1>
<p>Figure 18.12 shows time plots of monthly sales of six types of Australian wines (red, rose, sweet white, dry white, sparkling, and fortified) for 1980-1994. [Data are available in <em>AustralianWines.csv</em>, Source: Hyndman and Yang (2018).] The units are thousands of litres. You are hired to obtain short-term forecasts (2-3~months ahead) for each of the six series, and this task will be repeated every month.</p>
<div id="cell-46" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(DATA <span class="op">/</span> <span class="st">'AustralianWines.csv'</span>, na_values<span class="op">=</span>[<span class="st">'*'</span>])</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(df.Month, <span class="bu">format</span><span class="op">=</span><span class="st">'%b-%y'</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Month</th>
<th data-quarto-table-cell-role="th">Fortified</th>
<th data-quarto-table-cell-role="th">Red</th>
<th data-quarto-table-cell-role="th">Rose</th>
<th data-quarto-table-cell-role="th">sparkling</th>
<th data-quarto-table-cell-role="th">Sweet white</th>
<th data-quarto-table-cell-role="th">Dry white</th>
<th data-quarto-table-cell-role="th">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Jan-80</td>
<td>2585</td>
<td>464</td>
<td>112.0</td>
<td>1686</td>
<td>85</td>
<td>1954</td>
<td>1980-01-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Feb-80</td>
<td>3368</td>
<td>675</td>
<td>118.0</td>
<td>1591</td>
<td>89</td>
<td>2302</td>
<td>1980-02-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Mar-80</td>
<td>3210</td>
<td>703</td>
<td>129.0</td>
<td>2304</td>
<td>109</td>
<td>3054</td>
<td>1980-03-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Apr-80</td>
<td>3111</td>
<td>887</td>
<td>99.0</td>
<td>1712</td>
<td>95</td>
<td>2414</td>
<td>1980-04-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>May-80</td>
<td>3756</td>
<td>1139</td>
<td>116.0</td>
<td>1471</td>
<td>91</td>
<td>2226</td>
<td>1980-05-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-47" class="cell" data-scrolled="false" data-execution_count="22">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">12</span>))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> [</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'ax'</span>: axes[<span class="dv">0</span>, <span class="dv">0</span>], <span class="st">'title'</span>: <span class="st">'Sweet white'</span>, <span class="st">'y'</span>: <span class="st">'Sweet white'</span>},</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'ax'</span>: axes[<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'title'</span>: <span class="st">'Rose wine'</span>, <span class="st">'y'</span>: <span class="st">'Rose'</span>},</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'ax'</span>: axes[<span class="dv">1</span>, <span class="dv">0</span>], <span class="st">'title'</span>: <span class="st">'Sparkling wine'</span>, <span class="st">'y'</span>: <span class="st">'sparkling'</span>},</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'ax'</span>: axes[<span class="dv">1</span>, <span class="dv">1</span>], <span class="st">'title'</span>: <span class="st">'Red wine'</span>, <span class="st">'y'</span>: <span class="st">'Red'</span>},</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'ax'</span>: axes[<span class="dv">2</span>, <span class="dv">0</span>], <span class="st">'title'</span>: <span class="st">'Dry white wine'</span>, <span class="st">'y'</span>: <span class="st">'Dry white'</span>},</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'ax'</span>: axes[<span class="dv">2</span>, <span class="dv">1</span>], <span class="st">'title'</span>: <span class="st">'Fortified wine'</span>, <span class="st">'y'</span>: <span class="st">'Fortified'</span>},</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> warnings.catch_warnings():</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    warnings.simplefilter(<span class="st">"ignore"</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> param <span class="kw">in</span> params:</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> df.plot(x<span class="op">=</span><span class="st">'Date'</span>, <span class="op">**</span>param)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        ax.set_xlabel(<span class="st">''</span>)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(<span class="st">'Thousands of litres'</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        ax.get_legend().remove()</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="solution-18.9.a" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.9.a">Solution 18.9.a</h2>
<p>Which forecasting method would you choose if you had to choose the same method for all series? Why?</p>
<p>Model/Method: Holt-Winter’s exponential smoothing Reasons: 1. Ability of the model to capture both seasonality and trend that are present in the various data series. 2. Adaptability of the model - will adapt to the various patterns of different data series. 3. Holt-Winter’s model is a reasonable model for all series - it will be able to capture and adjust to changing levels of trends and seasonality swings. It is parsimonious and should produce good fit as well as good forecasts.</p>
</section>
<section id="solution-18.9.b" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.9.b">Solution 18.9.b</h2>
<p>Fortified wine has the largest market share of the above six types of wine. You are asked to focus on fortified wine sales alone, and produce as accurate as possible forecasts for the next 2 months.</p>
<ul>
<li>Start by partitioning the data using the period until December 1993 as the training set.</li>
<li>Apply Holt-Winter’s exponential smoothing to sales with an appropriate season length (use smoothing parameters <span class="math inline">\(\alpha=0.2, \beta=0.15, \gamma=0.05\)</span>).</li>
</ul>
<div id="cell-49" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(DATA <span class="op">/</span> <span class="st">'AustralianWines.csv'</span>, na_values<span class="op">=</span>[<span class="st">'*'</span>])</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Date'</span>] <span class="op">=</span> pd.to_datetime(df.Month, <span class="bu">format</span><span class="op">=</span><span class="st">'%b-%y'</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>df.index <span class="op">=</span> df.Date</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>train_df <span class="op">=</span> df[:<span class="st">'1993-12-31'</span>].Fortified</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>valid_df <span class="op">=</span> df[<span class="st">'1994-01-01'</span>:].Fortified</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> train_df.plot()</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>valid_df.plot(ax<span class="op">=</span>ax)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-50" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>expSmooth <span class="op">=</span> ExponentialSmoothing(train_df, trend<span class="op">=</span><span class="st">'additive'</span>, seasonal<span class="op">=</span><span class="st">'additive'</span>, seasonal_periods<span class="op">=</span><span class="dv">12</span>, freq<span class="op">=</span><span class="st">'MS'</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>expSmoothFit <span class="op">=</span> expSmooth.fit(smoothing_level<span class="op">=</span><span class="fl">0.2</span>, smoothing_slope<span class="op">=</span><span class="fl">0.15</span>, smoothing_seasonal<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> train_df.plot(color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>train_df.plot(ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>expSmoothFit.fittedvalues.plot(ax<span class="op">=</span>ax)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>expSmoothFit.forecast(<span class="bu">len</span>(valid_df)).plot(ax<span class="op">=</span>ax, style<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, color<span class="op">=</span><span class="st">'C0'</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="solution-18.9.c" class="level2">
<h2 class="anchored" data-anchor-id="solution-18.9.c">Solution 18.9.c</h2>
<p>Create an ACF plot for the residuals from the Holt-Winter’s exponential smoothing until lag-12.</p>
<div id="cell-52" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tsaplots.plot_acf(expSmoothFit.resid)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">13</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="solution-18.9.c.i" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.9.c.i">Solution 18.9.c.i</h3>
<p>Examining this plot, which of the following statements are reasonable conclusions?</p>
<ul>
<li>Decembers (month 12) are not captured well by the model.</li>
<li>There is a strong correlation between sales on the same calendar month.</li>
<li>The model does not capture the seasonality well.</li>
<li>We should try to fit an autoregressive model with lag-12 to the residuals.</li>
<li>We should first deseasonalize the data and then apply Holt-Winter’s exponential smoothing.</li>
</ul>
<p>Answers: - Decembers (month 12) are not captured well by the model. - NO - There is a strong correlation between sales on the same calendar month. - YES - The model does not capture the seasonality well. - YES - We should try to fit an autoregressive model with lag-12 to the residuals. - YES - We should first deseasonalize the data and then apply Holt-Winter’s exponential smoothing. - NO</p>
</section>
<section id="solution-18.9.c.i-1" class="level3">
<h3 class="anchored" data-anchor-id="solution-18.9.c.i-1">Solution 18.9.c.i</h3>
<p>How can you handle the above effect without adding another layer to your model?</p>
<p>Increase gamma in Holt-Winters model.</p>
<div id="cell-54" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>expSmooth <span class="op">=</span> ExponentialSmoothing(train_df, trend<span class="op">=</span><span class="st">'additive'</span>, seasonal<span class="op">=</span><span class="st">'additive'</span>, seasonal_periods<span class="op">=</span><span class="dv">12</span>, freq<span class="op">=</span><span class="st">'MS'</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>expSmoothFit <span class="op">=</span> expSmooth.fit(smoothing_level<span class="op">=</span><span class="fl">0.2</span>, smoothing_slope<span class="op">=</span><span class="fl">0.15</span>, smoothing_seasonal<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>tsaplots.plot_acf(expSmoothFit.resid)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">0</span>, <span class="dv">13</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Ch-18-ProbSolutions-SM_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>