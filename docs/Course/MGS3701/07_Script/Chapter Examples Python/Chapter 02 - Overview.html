<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 2: Overview of the Data Mining Process – Chad’s Course Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Chad’s Course Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../Course/GE2021/03_Lecture_Note/LectureNote_Chad/PPT/chapter0/chapter0.html"> 
<span class="menu-text">test</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-required-packages" id="toc-import-required-packages" class="nav-link active" data-scroll-target="#import-required-packages">Import required packages</a></li>
  <li><a href="#table-2.3" id="toc-table-2.3" class="nav-link" data-scroll-target="#table-2.3">Table 2.3</a></li>
  <li><a href="#cleanup" id="toc-cleanup" class="nav-link" data-scroll-target="#cleanup">Cleanup</a></li>
  <li><a href="#accessing-subsets-of-the-data" id="toc-accessing-subsets-of-the-data" class="nav-link" data-scroll-target="#accessing-subsets-of-the-data">Accessing subsets of the data</a></li>
  <li><a href="#table-2.4" id="toc-table-2.4" class="nav-link" data-scroll-target="#table-2.4">Table 2.4</a></li>
  <li><a href="#table-2.5" id="toc-table-2.5" class="nav-link" data-scroll-target="#table-2.5">Table 2.5</a></li>
  <li><a href="#table-2.6" id="toc-table-2.6" class="nav-link" data-scroll-target="#table-2.6">Table 2.6</a></li>
  <li><a href="#table-2.7" id="toc-table-2.7" class="nav-link" data-scroll-target="#table-2.7">Table 2.7</a></li>
  <li><a href="#table---scaling-data" id="toc-table---scaling-data" class="nav-link" data-scroll-target="#table---scaling-data">Table - scaling data</a></li>
  <li><a href="#table-2.9" id="toc-table-2.9" class="nav-link" data-scroll-target="#table-2.9">Table 2.9</a></li>
  <li><a href="#table-2.11" id="toc-table-2.11" class="nav-link" data-scroll-target="#table-2.11">Table 2.11</a></li>
  <li><a href="#table-2.13" id="toc-table-2.13" class="nav-link" data-scroll-target="#table-2.13">Table 2.13</a></li>
  <li><a href="#table-2.14" id="toc-table-2.14" class="nav-link" data-scroll-target="#table-2.14">Table 2.14</a></li>
  <li><a href="#figure-2.2-and-2.3" id="toc-figure-2.2-and-2.3" class="nav-link" data-scroll-target="#figure-2.2-and-2.3">Figure 2.2 and 2.3</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 2: Overview of the Data Mining Process</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<ol start="3" type="a">
<li>2019 Galit Shmueli, Peter C. Bruce, Peter Gedeck</li>
</ol>
<p>Code included in</p>
<p><em>Data Mining for Business Analytics: Concepts, Techniques, and Applications in Python</em> (First Edition) Galit Shmueli, Peter C. Bruce, Peter Gedeck, and Nitin R. Patel. 2019.</p>
</blockquote>
<section id="import-required-packages" class="level2">
<h2 class="anchored" data-anchor-id="import-required-packages">Import required packages</h2>
<p>We use the pandas, the Python data anlysis library, for handling data. The API of this library is very similar to R data frames. See https://pandas.pydata.org/ for details.</p>
<div id="cell-2" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:23.241081Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:23.240640Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.039989Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.039441Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dmba</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pylab <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>no display found. Using non-interactive Agg backend</code></pre>
</div>
</div>
<p>Note that we import some of the packages using an alias notation, to make the code more readable.</p>
<pre><code>import &lt;package&gt; as &lt;alias&gt;</code></pre>
<p>The aliases <code>np</code>, <code>pd</code>, and <code>plt</code> are commonly used in the data science community.</p>
<p>The following statement defines the location of the data files in your file system. Here we assume that the data folder is located in the parent folder of this ipython notebook.</p>
</section>
<section id="table-2.3" class="level2">
<h2 class="anchored" data-anchor-id="table-2.3">Table 2.3</h2>
<p>Load the West Roxbury data set</p>
<div id="cell-6" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.049745Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.049327Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.062355Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.061850Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>housing_df <span class="op">=</span> dmba.load_data(<span class="st">'WestRoxbury.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Determine the shape of the data frame. It has 5802 rows and 14 columns</p>
<div id="cell-8" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.066936Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.066519Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.069467Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.069810Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>housing_df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(5802, 14)</code></pre>
</div>
</div>
<p>Show the top rows of the dataframe</p>
<div id="cell-10" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.073503Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.073108Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.085050Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.084569Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>housing_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TOTAL VALUE</th>
<th data-quarto-table-cell-role="th">TAX</th>
<th data-quarto-table-cell-role="th">LOT SQFT</th>
<th data-quarto-table-cell-role="th">YR BUILT</th>
<th data-quarto-table-cell-role="th">GROSS AREA</th>
<th data-quarto-table-cell-role="th">LIVING AREA</th>
<th data-quarto-table-cell-role="th">FLOORS</th>
<th data-quarto-table-cell-role="th">ROOMS</th>
<th data-quarto-table-cell-role="th">BEDROOMS</th>
<th data-quarto-table-cell-role="th">FULL BATH</th>
<th data-quarto-table-cell-role="th">HALF BATH</th>
<th data-quarto-table-cell-role="th">KITCHEN</th>
<th data-quarto-table-cell-role="th">FIREPLACE</th>
<th data-quarto-table-cell-role="th">REMODEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>344.2</td>
<td>4330</td>
<td>9965</td>
<td>1880</td>
<td>2436</td>
<td>1352</td>
<td>2.0</td>
<td>6</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>412.6</td>
<td>5190</td>
<td>6590</td>
<td>1945</td>
<td>3108</td>
<td>1976</td>
<td>2.0</td>
<td>10</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>Recent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>330.1</td>
<td>4152</td>
<td>7500</td>
<td>1890</td>
<td>2294</td>
<td>1371</td>
<td>2.0</td>
<td>8</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>498.6</td>
<td>6272</td>
<td>13773</td>
<td>1957</td>
<td>5032</td>
<td>2608</td>
<td>1.0</td>
<td>9</td>
<td>5</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>None</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>331.5</td>
<td>4170</td>
<td>5000</td>
<td>1910</td>
<td>2370</td>
<td>1438</td>
<td>2.0</td>
<td>7</td>
<td>3</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="cleanup" class="level2">
<h2 class="anchored" data-anchor-id="cleanup">Cleanup</h2>
<p>Preprocessing and cleaning up data is an important aspect of data analysis.</p>
<p>Show the column names.</p>
<div id="cell-12" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.088493Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.088107Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.091056Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.091436Z&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>housing_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Index(['TOTAL VALUE ', 'TAX', 'LOT SQFT ', 'YR BUILT', 'GROSS AREA ',
       'LIVING AREA', 'FLOORS ', 'ROOMS', 'BEDROOMS ', 'FULL BATH',
       'HALF BATH', 'KITCHEN', 'FIREPLACE', 'REMODEL'],
      dtype='object')</code></pre>
</div>
</div>
<p>Note that some column titles end with spaces and some consist of two space separated words. For further analysis it’s more convenient to have column names which are single words.</p>
<p>In the rename command you can specify individual columns by name and provide their new name using a dictionary. Note that we use the <code>inplace</code> argument here. This means that the data frame is modified directly. By default, the modification is done on a copy and the copy returned by the method.</p>
<div id="cell-14" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.094722Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.094193Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.099319Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.098829Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>housing_df <span class="op">=</span> housing_df.rename(columns<span class="op">=</span>{<span class="st">'TOTAL VALUE '</span>: <span class="st">'TOTAL_VALUE'</span>})</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>housing_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Index(['TOTAL_VALUE', 'TAX', 'LOT SQFT ', 'YR BUILT', 'GROSS AREA ',
       'LIVING AREA', 'FLOORS ', 'ROOMS', 'BEDROOMS ', 'FULL BATH',
       'HALF BATH', 'KITCHEN', 'FIREPLACE', 'REMODEL'],
      dtype='object')</code></pre>
</div>
</div>
<p>We therefore strip trailing spaces and replace the remaining spaces with an underscore _. Instead of using the <code>rename</code> method, we create a modified copy of <code>columns</code> and assign to the <code>columns</code> field of the dataframe.</p>
<div id="cell-16" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.104538Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.104093Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.107603Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.107235Z&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>housing_df.columns <span class="op">=</span> [s.strip().replace(<span class="st">' '</span>, <span class="st">'_'</span>) <span class="cf">for</span> s <span class="kw">in</span> housing_df.columns]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>housing_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Index(['TOTAL_VALUE', 'TAX', 'LOT_SQFT', 'YR_BUILT', 'GROSS_AREA',
       'LIVING_AREA', 'FLOORS', 'ROOMS', 'BEDROOMS', 'FULL_BATH', 'HALF_BATH',
       'KITCHEN', 'FIREPLACE', 'REMODEL'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="accessing-subsets-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="accessing-subsets-of-the-data">Accessing subsets of the data</h2>
<p>Pandas uses two methods to access rows in a data frame; <code>loc</code> and <code>iloc</code>. The <code>loc</code> method is more general and allows accessing rows using labels. The <code>iloc</code> method on the other hand only allows using integer numbers. To specify a range of rows use the slice notation, e.g.&nbsp;<code>0:9</code>.</p>
<div class="alert alert-info">
Note that in contrast to R, Python uses 0-indexing, which means that indices start at 0 and not at 1.
</div>
<p>To show the first four rows of the data frame, you can use the following commands.</p>
<div id="cell-18" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.118647Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.118095Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.121840Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.121452Z&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>housing_df.loc[<span class="dv">0</span>:<span class="dv">3</span>]  <span class="co"># for loc, the second index in the slice is inclusive</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TOTAL_VALUE</th>
<th data-quarto-table-cell-role="th">TAX</th>
<th data-quarto-table-cell-role="th">LOT_SQFT</th>
<th data-quarto-table-cell-role="th">YR_BUILT</th>
<th data-quarto-table-cell-role="th">GROSS_AREA</th>
<th data-quarto-table-cell-role="th">LIVING_AREA</th>
<th data-quarto-table-cell-role="th">FLOORS</th>
<th data-quarto-table-cell-role="th">ROOMS</th>
<th data-quarto-table-cell-role="th">BEDROOMS</th>
<th data-quarto-table-cell-role="th">FULL_BATH</th>
<th data-quarto-table-cell-role="th">HALF_BATH</th>
<th data-quarto-table-cell-role="th">KITCHEN</th>
<th data-quarto-table-cell-role="th">FIREPLACE</th>
<th data-quarto-table-cell-role="th">REMODEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>344.2</td>
<td>4330</td>
<td>9965</td>
<td>1880</td>
<td>2436</td>
<td>1352</td>
<td>2.0</td>
<td>6</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>412.6</td>
<td>5190</td>
<td>6590</td>
<td>1945</td>
<td>3108</td>
<td>1976</td>
<td>2.0</td>
<td>10</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>Recent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>330.1</td>
<td>4152</td>
<td>7500</td>
<td>1890</td>
<td>2294</td>
<td>1371</td>
<td>2.0</td>
<td>8</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>498.6</td>
<td>6272</td>
<td>13773</td>
<td>1957</td>
<td>5032</td>
<td>2608</td>
<td>1.0</td>
<td>9</td>
<td>5</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>None</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-19" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.131964Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.131525Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.135103Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.134590Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>housing_df.iloc[<span class="dv">0</span>:<span class="dv">4</span>]  <span class="co"># for loc, the second index in the slice is exclusive</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TOTAL_VALUE</th>
<th data-quarto-table-cell-role="th">TAX</th>
<th data-quarto-table-cell-role="th">LOT_SQFT</th>
<th data-quarto-table-cell-role="th">YR_BUILT</th>
<th data-quarto-table-cell-role="th">GROSS_AREA</th>
<th data-quarto-table-cell-role="th">LIVING_AREA</th>
<th data-quarto-table-cell-role="th">FLOORS</th>
<th data-quarto-table-cell-role="th">ROOMS</th>
<th data-quarto-table-cell-role="th">BEDROOMS</th>
<th data-quarto-table-cell-role="th">FULL_BATH</th>
<th data-quarto-table-cell-role="th">HALF_BATH</th>
<th data-quarto-table-cell-role="th">KITCHEN</th>
<th data-quarto-table-cell-role="th">FIREPLACE</th>
<th data-quarto-table-cell-role="th">REMODEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>344.2</td>
<td>4330</td>
<td>9965</td>
<td>1880</td>
<td>2436</td>
<td>1352</td>
<td>2.0</td>
<td>6</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>412.6</td>
<td>5190</td>
<td>6590</td>
<td>1945</td>
<td>3108</td>
<td>1976</td>
<td>2.0</td>
<td>10</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>Recent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>330.1</td>
<td>4152</td>
<td>7500</td>
<td>1890</td>
<td>2294</td>
<td>1371</td>
<td>2.0</td>
<td>8</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>498.6</td>
<td>6272</td>
<td>13773</td>
<td>1957</td>
<td>5032</td>
<td>2608</td>
<td>1.0</td>
<td>9</td>
<td>5</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>None</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note the difference in the two methods with respect to the slice notation! For consistency with how slices are defined in Python, we will use the <code>iloc</code> method mostly from here on.</p>
<p>Next, show the first ten rows of the first column</p>
<div id="cell-21" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.140499Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.140076Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.143532Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.143150Z&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>housing_df[<span class="st">'TOTAL_VALUE'</span>].iloc[<span class="dv">0</span>:<span class="dv">10</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>housing_df.iloc[<span class="dv">0</span>:<span class="dv">10</span>][<span class="st">'TOTAL_VALUE'</span>]  <span class="co"># the order is not important</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>housing_df.iloc[<span class="dv">0</span>:<span class="dv">10</span>].TOTAL_VALUE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0    344.2
1    412.6
2    330.1
3    498.6
4    331.5
5    337.4
6    359.4
7    320.4
8    333.5
9    409.4
Name: TOTAL_VALUE, dtype: float64</code></pre>
</div>
</div>
<p>Show the fifth row of the first 10 columns. The <code>iloc</code> methods allows specifying the rows and columns within one set of brackets. <code>dataframe.iloc[rows, columns]</code></p>
<div id="cell-23" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.148495Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.148091Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.151624Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.151203Z&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>housing_df.iloc[<span class="dv">4</span>][<span class="dv">0</span>:<span class="dv">10</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>housing_df.iloc[<span class="dv">4</span>, <span class="dv">0</span>:<span class="dv">10</span>]  <span class="co"># this is equivalent</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>TOTAL_VALUE    331.5
TAX             4170
LOT_SQFT        5000
YR_BUILT        1910
GROSS_AREA      2370
LIVING_AREA     1438
FLOORS           2.0
ROOMS              7
BEDROOMS           3
FULL_BATH          2
Name: 4, dtype: object</code></pre>
</div>
</div>
<p>If you prefer to preserve the data frame format, use a slice for the rows as well.</p>
<div id="cell-25" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.160462Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.159883Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.163381Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.162970Z&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>housing_df.iloc[<span class="dv">4</span>:<span class="dv">5</span>, <span class="dv">0</span>:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TOTAL_VALUE</th>
<th data-quarto-table-cell-role="th">TAX</th>
<th data-quarto-table-cell-role="th">LOT_SQFT</th>
<th data-quarto-table-cell-role="th">YR_BUILT</th>
<th data-quarto-table-cell-role="th">GROSS_AREA</th>
<th data-quarto-table-cell-role="th">LIVING_AREA</th>
<th data-quarto-table-cell-role="th">FLOORS</th>
<th data-quarto-table-cell-role="th">ROOMS</th>
<th data-quarto-table-cell-role="th">BEDROOMS</th>
<th data-quarto-table-cell-role="th">FULL_BATH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>331.5</td>
<td>4170</td>
<td>5000</td>
<td>1910</td>
<td>2370</td>
<td>1438</td>
<td>2.0</td>
<td>7</td>
<td>3</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Use the <code>pd.concat</code> method if you want to combine non-consecutive columns into a new data frame. The <code>axis</code> argument specifies the dimension along which the concatenation happens, 0=rows, 1=columns.</p>
<div id="cell-27" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.171450Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.171050Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.174602Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.175054Z&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pd.concat([housing_df.iloc[<span class="dv">4</span>:<span class="dv">6</span>,<span class="dv">0</span>:<span class="dv">2</span>], housing_df.iloc[<span class="dv">4</span>:<span class="dv">6</span>,<span class="dv">4</span>:<span class="dv">6</span>]], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TOTAL_VALUE</th>
<th data-quarto-table-cell-role="th">TAX</th>
<th data-quarto-table-cell-role="th">GROSS_AREA</th>
<th data-quarto-table-cell-role="th">LIVING_AREA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>331.5</td>
<td>4170</td>
<td>2370</td>
<td>1438</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>337.4</td>
<td>4244</td>
<td>2124</td>
<td>1060</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>To specify a full column, use the <code>:</code> on its own.</p>
<pre><code>housing_df.iloc[:,0:1]</code></pre>
<p>A often more practical way is to use the column name as follows</p>
<div id="cell-29" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.179896Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.179438Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.182295Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.182591Z&quot;}" data-scrolled="false" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>housing_df[<span class="st">'TOTAL_VALUE'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0       344.2
1       412.6
2       330.1
3       498.6
4       331.5
        ...  
5797    404.8
5798    407.9
5799    406.5
5800    308.7
5801    447.6
Name: TOTAL_VALUE, Length: 5802, dtype: float64</code></pre>
</div>
</div>
<p>We can subset the column using a slice</p>
<div id="cell-31" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.186785Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.186355Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.189544Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.189909Z&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>housing_df[<span class="st">'TOTAL_VALUE'</span>][<span class="dv">0</span>:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0    344.2
1    412.6
2    330.1
3    498.6
4    331.5
5    337.4
6    359.4
7    320.4
8    333.5
9    409.4
Name: TOTAL_VALUE, dtype: float64</code></pre>
</div>
</div>
<p>Pandas provides a number of ways to access statistics of the columns.</p>
<div id="cell-33" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.194614Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.193829Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.196168Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.195798Z&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows '</span>, <span class="bu">len</span>(housing_df[<span class="st">'TOTAL_VALUE'</span>]))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Mean of TOTAL_VALUE '</span>, housing_df[<span class="st">'TOTAL_VALUE'</span>].mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows  5802
Mean of TOTAL_VALUE  392.6857149258877</code></pre>
</div>
</div>
<p>A data frame also has the method <code>describe</code> that prints a number of common statistics</p>
<div id="cell-35" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.200700Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.199752Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.206166Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.205785Z&quot;}" data-execution_count="18">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>housing_df[<span class="st">'TOTAL_VALUE'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>count    5802.000000
mean      392.685715
std        99.177414
min       105.000000
25%       325.125000
50%       375.900000
75%       438.775000
max      1217.800000
Name: TOTAL_VALUE, dtype: float64</code></pre>
</div>
</div>
<div id="cell-36" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.211704Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.211187Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.249397Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.249007Z&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>housing_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TOTAL_VALUE</th>
<th data-quarto-table-cell-role="th">TAX</th>
<th data-quarto-table-cell-role="th">LOT_SQFT</th>
<th data-quarto-table-cell-role="th">YR_BUILT</th>
<th data-quarto-table-cell-role="th">GROSS_AREA</th>
<th data-quarto-table-cell-role="th">LIVING_AREA</th>
<th data-quarto-table-cell-role="th">FLOORS</th>
<th data-quarto-table-cell-role="th">ROOMS</th>
<th data-quarto-table-cell-role="th">BEDROOMS</th>
<th data-quarto-table-cell-role="th">FULL_BATH</th>
<th data-quarto-table-cell-role="th">HALF_BATH</th>
<th data-quarto-table-cell-role="th">KITCHEN</th>
<th data-quarto-table-cell-role="th">FIREPLACE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.000000</td>
<td>5802.00000</td>
<td>5802.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>392.685715</td>
<td>4939.485867</td>
<td>6278.083764</td>
<td>1936.744916</td>
<td>2924.842123</td>
<td>1657.065322</td>
<td>1.683730</td>
<td>6.994829</td>
<td>3.230093</td>
<td>1.296794</td>
<td>0.613926</td>
<td>1.01534</td>
<td>0.739917</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>99.177414</td>
<td>1247.649118</td>
<td>2669.707974</td>
<td>35.989910</td>
<td>883.984726</td>
<td>540.456726</td>
<td>0.444884</td>
<td>1.437657</td>
<td>0.846607</td>
<td>0.522040</td>
<td>0.533839</td>
<td>0.12291</td>
<td>0.565108</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>105.000000</td>
<td>1320.000000</td>
<td>997.000000</td>
<td>0.000000</td>
<td>821.000000</td>
<td>504.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>1.00000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>325.125000</td>
<td>4089.500000</td>
<td>4772.000000</td>
<td>1920.000000</td>
<td>2347.000000</td>
<td>1308.000000</td>
<td>1.000000</td>
<td>6.000000</td>
<td>3.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>1.00000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>375.900000</td>
<td>4728.000000</td>
<td>5683.000000</td>
<td>1935.000000</td>
<td>2700.000000</td>
<td>1548.500000</td>
<td>2.000000</td>
<td>7.000000</td>
<td>3.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.00000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>438.775000</td>
<td>5519.500000</td>
<td>7022.250000</td>
<td>1955.000000</td>
<td>3239.000000</td>
<td>1873.750000</td>
<td>2.000000</td>
<td>8.000000</td>
<td>4.000000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>1.00000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1217.800000</td>
<td>15319.000000</td>
<td>46411.000000</td>
<td>2011.000000</td>
<td>8154.000000</td>
<td>5289.000000</td>
<td>3.000000</td>
<td>14.000000</td>
<td>9.000000</td>
<td>5.000000</td>
<td>3.000000</td>
<td>2.00000</td>
<td>4.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="table-2.4" class="level2">
<h2 class="anchored" data-anchor-id="table-2.4">Table 2.4</h2>
<p>Use the <code>sample</code> method to retrieve a random sample of observations. Here we sample 5 observations without replacement.</p>
<div id="cell-38" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.260750Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.260302Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.263538Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.263152Z&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>housing_df.sample(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TOTAL_VALUE</th>
<th data-quarto-table-cell-role="th">TAX</th>
<th data-quarto-table-cell-role="th">LOT_SQFT</th>
<th data-quarto-table-cell-role="th">YR_BUILT</th>
<th data-quarto-table-cell-role="th">GROSS_AREA</th>
<th data-quarto-table-cell-role="th">LIVING_AREA</th>
<th data-quarto-table-cell-role="th">FLOORS</th>
<th data-quarto-table-cell-role="th">ROOMS</th>
<th data-quarto-table-cell-role="th">BEDROOMS</th>
<th data-quarto-table-cell-role="th">FULL_BATH</th>
<th data-quarto-table-cell-role="th">HALF_BATH</th>
<th data-quarto-table-cell-role="th">KITCHEN</th>
<th data-quarto-table-cell-role="th">FIREPLACE</th>
<th data-quarto-table-cell-role="th">REMODEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1144</td>
<td>299.0</td>
<td>3761</td>
<td>6343</td>
<td>1950</td>
<td>2694</td>
<td>1201</td>
<td>1.0</td>
<td>4</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">320</td>
<td>440.2</td>
<td>5537</td>
<td>8247</td>
<td>1940</td>
<td>3210</td>
<td>1980</td>
<td>2.0</td>
<td>7</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>Recent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2122</td>
<td>498.0</td>
<td>6264</td>
<td>7375</td>
<td>1937</td>
<td>3243</td>
<td>1896</td>
<td>2.0</td>
<td>6</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>Recent</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3062</td>
<td>419.1</td>
<td>5272</td>
<td>5202</td>
<td>1925</td>
<td>3983</td>
<td>1529</td>
<td>1.0</td>
<td>8</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>Recent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4235</td>
<td>602.7</td>
<td>7581</td>
<td>12905</td>
<td>1915</td>
<td>3812</td>
<td>2087</td>
<td>2.5</td>
<td>7</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>None</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The sample method allows to specify weights for the individual rows. We use this here to oversample houses with over 10 rooms.</p>
<div id="cell-40" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.268087Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.267581Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.279875Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.280285Z&quot;}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> [<span class="fl">0.9</span> <span class="cf">if</span> rooms <span class="op">&gt;</span> <span class="dv">10</span> <span class="cf">else</span> <span class="fl">0.01</span> <span class="cf">for</span> rooms <span class="kw">in</span> housing_df.ROOMS]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>housing_df.sample(<span class="dv">5</span>, weights<span class="op">=</span>weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">TOTAL_VALUE</th>
<th data-quarto-table-cell-role="th">TAX</th>
<th data-quarto-table-cell-role="th">LOT_SQFT</th>
<th data-quarto-table-cell-role="th">YR_BUILT</th>
<th data-quarto-table-cell-role="th">GROSS_AREA</th>
<th data-quarto-table-cell-role="th">LIVING_AREA</th>
<th data-quarto-table-cell-role="th">FLOORS</th>
<th data-quarto-table-cell-role="th">ROOMS</th>
<th data-quarto-table-cell-role="th">BEDROOMS</th>
<th data-quarto-table-cell-role="th">FULL_BATH</th>
<th data-quarto-table-cell-role="th">HALF_BATH</th>
<th data-quarto-table-cell-role="th">KITCHEN</th>
<th data-quarto-table-cell-role="th">FIREPLACE</th>
<th data-quarto-table-cell-role="th">REMODEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">5273</td>
<td>294.7</td>
<td>3707</td>
<td>10551</td>
<td>1945</td>
<td>1092</td>
<td>999</td>
<td>1.0</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2866</td>
<td>337.1</td>
<td>4240</td>
<td>3687</td>
<td>1939</td>
<td>2247</td>
<td>1349</td>
<td>2.0</td>
<td>8</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>None</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2283</td>
<td>444.6</td>
<td>5593</td>
<td>8709</td>
<td>1956</td>
<td>3837</td>
<td>1718</td>
<td>1.0</td>
<td>7</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2687</td>
<td>397.1</td>
<td>4995</td>
<td>5000</td>
<td>1910</td>
<td>3014</td>
<td>1878</td>
<td>2.0</td>
<td>11</td>
<td>6</td>
<td>2</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>None</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4680</td>
<td>571.3</td>
<td>7186</td>
<td>7981</td>
<td>1886</td>
<td>4580</td>
<td>2480</td>
<td>2.0</td>
<td>11</td>
<td>6</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>None</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="table-2.5" class="level2">
<h2 class="anchored" data-anchor-id="table-2.5">Table 2.5</h2>
<div id="cell-42" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.283813Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.283380Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.286450Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.286860Z&quot;}" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>housing_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Index(['TOTAL_VALUE', 'TAX', 'LOT_SQFT', 'YR_BUILT', 'GROSS_AREA',
       'LIVING_AREA', 'FLOORS', 'ROOMS', 'BEDROOMS', 'FULL_BATH', 'HALF_BATH',
       'KITCHEN', 'FIREPLACE', 'REMODEL'],
      dtype='object')</code></pre>
</div>
</div>
<p>The REMODEL column is a factor, so we need to change it’s type.</p>
<div id="cell-44" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.292576Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.292175Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.295831Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.295385Z&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_df.REMODEL.dtype)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>housing_df.REMODEL <span class="op">=</span> housing_df.REMODEL.astype(<span class="st">'category'</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_df.REMODEL.cat.categories)  <span class="co"># It can take one of three levels</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_df.REMODEL.dtype)  <span class="co"># Type is now 'category'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>object
Index(['None', 'Old', 'Recent'], dtype='object')
category</code></pre>
</div>
</div>
<p>Other columns also have types.</p>
<div id="cell-46" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.299427Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.299050Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.302418Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.302090Z&quot;}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_df.BEDROOMS.dtype)  <span class="co"># BEDROOMS is an integer variable</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_df.TOTAL_VALUE.dtype)  <span class="co"># Total_Value is a numeric variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>int64
float64</code></pre>
</div>
</div>
<p>It’s also possible to the all columns data types</p>
<div id="cell-48" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.306966Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.306398Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.309421Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.309789Z&quot;}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>housing_df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>TOTAL_VALUE     float64
TAX               int64
LOT_SQFT          int64
YR_BUILT          int64
GROSS_AREA        int64
LIVING_AREA       int64
FLOORS          float64
ROOMS             int64
BEDROOMS          int64
FULL_BATH         int64
HALF_BATH         int64
KITCHEN           int64
FIREPLACE         int64
REMODEL        category
dtype: object</code></pre>
</div>
</div>
</section>
<section id="table-2.6" class="level2">
<h2 class="anchored" data-anchor-id="table-2.6">Table 2.6</h2>
<p>Pandas provides a method to convert factors into dummy variables.</p>
<div id="cell-50" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.318125Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.317666Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.322597Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.322971Z&quot;}" data-execution_count="26">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>housing_df <span class="op">=</span> pd.get_dummies(housing_df, prefix_sep<span class="op">=</span><span class="st">'_'</span>, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>housing_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Index(['TOTAL_VALUE', 'TAX', 'LOT_SQFT', 'YR_BUILT', 'GROSS_AREA',
       'LIVING_AREA', 'FLOORS', 'ROOMS', 'BEDROOMS', 'FULL_BATH', 'HALF_BATH',
       'KITCHEN', 'FIREPLACE', 'REMODEL_Old', 'REMODEL_Recent'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-51" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.328587Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.328197Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.330773Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.330453Z&quot;}" data-execution_count="27">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_df.loc[:, <span class="st">'REMODEL_Old'</span>:<span class="st">'REMODEL_Recent'</span>].head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   REMODEL_Old  REMODEL_Recent
0            0               0
1            0               1
2            0               0
3            0               0
4            0               0</code></pre>
</div>
</div>
</section>
<section id="table-2.7" class="level2">
<h2 class="anchored" data-anchor-id="table-2.7">Table 2.7</h2>
<p>To illustrate missing data procedures, we first convert a few entries for bedrooms to NA’s. Then we impute these missing values using the median of the remaining values.</p>
<div id="cell-53" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.334940Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.334522Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.341546Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.341208Z&quot;}" data-execution_count="28">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows with valid BEDROOMS values before: '</span>, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>      housing_df[<span class="st">'BEDROOMS'</span>].count()) </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>missingRows <span class="op">=</span> housing_df.sample(<span class="dv">10</span>).index</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>housing_df.loc[missingRows, <span class="st">'BEDROOMS'</span>] <span class="op">=</span> np.nan</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows with valid BEDROOMS values after setting to NAN: '</span>, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      housing_df[<span class="st">'BEDROOMS'</span>].count()) </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>housing_df[<span class="st">'BEDROOMS'</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows with valid BEDROOMS values before:  5802
Number of rows with valid BEDROOMS values after setting to NAN:  5792</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5792</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.346211Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.345487Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.350156Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.349831Z&quot;}" data-execution_count="29">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove rows with missing values </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>reduced_df <span class="op">=</span> housing_df.dropna()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows after removing rows with missing values: '</span>, <span class="bu">len</span>(reduced_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows after removing rows with missing values:  5792</code></pre>
</div>
</div>
<p>Replace the missing values using the median of the remaining values.</p>
<p>By default, the <code>median</code> method of a pandas dataframe ignores NA values. This is in contrast to R where this must be specified explicitly.</p>
<div id="cell-56" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.353487Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.353069Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.357335Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.357637Z&quot;}" data-execution_count="30">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>medianBedrooms <span class="op">=</span> housing_df[<span class="st">'BEDROOMS'</span>].median()</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>housing_df.BEDROOMS <span class="op">=</span> housing_df.BEDROOMS.fillna(value<span class="op">=</span>medianBedrooms)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of rows with valid BEDROOMS values after filling NA values: '</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>      housing_df[<span class="st">'BEDROOMS'</span>].count())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows with valid BEDROOMS values after filling NA values:  5802</code></pre>
</div>
</div>
</section>
<section id="table---scaling-data" class="level2">
<h2 class="anchored" data-anchor-id="table---scaling-data">Table - scaling data</h2>
<div id="cell-58" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.361939Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.361487Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.384839Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.384470Z&quot;}" data-execution_count="31">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler, StandardScaler</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> housing_df.copy()</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalizing a data frame</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pandas:</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>norm_df <span class="op">=</span> (housing_df <span class="op">-</span> housing_df.mean()) <span class="op">/</span> housing_df.std()</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># scikit-learn: </span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>norm_df <span class="op">=</span> pd.DataFrame(scaler.fit_transform(housing_df), </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>                       index<span class="op">=</span>housing_df.index, columns<span class="op">=</span>housing_df.columns)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># the result of the transformation is a numpy array, we convert it into a dataframe</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescaling a data frame</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># pandas:</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>rescaled_df <span class="op">=</span> (housing_df <span class="op">-</span> housing_df.<span class="bu">min</span>()) <span class="op">/</span> (housing_df.<span class="bu">max</span>() <span class="op">-</span> housing_df.<span class="bu">min</span>())</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co"># scikit-learn:</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>rescaled_df <span class="op">=</span> pd.DataFrame(scaler.fit_transform(housing_df), </span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>                       index<span class="op">=</span>housing_df.index, columns<span class="op">=</span>housing_df.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
The standardization of the dataset may give a <code>DataConversionWarning</code>. This informs you that the integer columns in the dataframe are automatically converted to real numbers (<code>float64</code>). This is expected and you can therefore ignore this warning. If you want to suppress the warning, you can explicitly convert the integer columns to real numbers
<p></p>
<pre># Option 1: Identify all integer columns, remove personal loan, 
# and change their type
intColumns = [c for c in housing_df.columns if housing_df[c].dtype == 'int']
housing_df[intColumns] = housing_df[intColumns].astype('float64')
</pre>
Alternatively, you can suppress the warning as follows:
<pre># Option 2: use the warnings package to suppress the display of the warning
import warnings
with warnings.catch_warnings():
    warnings.simplefilter('ignore')
    norm_df = pd.DataFrame(scaler.fit_transform(housing_df), 
                       index=housing_df.index, columns=housing_df.columns)    
</pre>
</section>
<section id="table-2.9" class="level2">
<h2 class="anchored" data-anchor-id="table-2.9">Table 2.9</h2>
<p>Split the dataset into training (60%) and validation (40%) sets. Randomly sample 60% of the dataset into a new data frame <code>trainData</code>. The remaining 40% serve as validation.</p>
<div id="cell-61" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.390142Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.389686Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.395645Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.395297Z&quot;}" data-execution_count="32">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random_state is set to a defined value to get the same partitions when re-running the code</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>trainData<span class="op">=</span> housing_df.sample(frac<span class="op">=</span><span class="fl">0.6</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># assign rows that are not already in the training set, into validation </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>validData <span class="op">=</span> housing_df.drop(trainData.index)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Training   : '</span>, trainData.shape)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Validation : '</span>, validData.shape)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># alternative way using scikit-learn</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>trainData, validData <span class="op">=</span> train_test_split(housing_df, test_size<span class="op">=</span><span class="fl">0.40</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Training   : '</span>, trainData.shape)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Validation : '</span>, validData.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training   :  (3481, 15)
Validation :  (2321, 15)

Training   :  (3481, 15)
Validation :  (2321, 15)</code></pre>
</div>
</div>
<p>Partition the dataset into training (50%), validation (30%), and test sets (20%).</p>
<div id="cell-63" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.401145Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.400131Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.412063Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.411640Z&quot;}" data-execution_count="33">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># randomly sample 50% of the row IDs for training</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>trainData <span class="op">=</span> housing_df.sample(frac<span class="op">=</span><span class="fl">0.5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sample 30% of the row IDs into the validation set, drawing only from records</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># not already in the training set; 60% of 50% is 30%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>validData <span class="op">=</span> housing_df.drop(trainData.index).sample(frac<span class="op">=</span><span class="fl">0.6</span>, random_state<span class="op">=</span><span class="dv">1</span>)  </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the remaining 20% rows serve as test</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>testData <span class="op">=</span> housing_df.drop(trainData.index).drop(validData.index)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Training   : '</span>, trainData.shape)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Validation : '</span>, validData.shape)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test       : '</span>, testData.shape)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># alternative way using scikit-learn</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>trainData, temp <span class="op">=</span> train_test_split(housing_df, test_size<span class="op">=</span><span class="fl">0.5</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>validData, testData <span class="op">=</span> train_test_split(temp, test_size<span class="op">=</span><span class="fl">0.4</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Training   : '</span>, trainData.shape)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Validation : '</span>, validData.shape)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test       : '</span>, testData.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training   :  (2901, 15)
Validation :  (1741, 15)
Test       :  (1160, 15)

Training   :  (2901, 15)
Validation :  (1740, 15)
Test       :  (1161, 15)</code></pre>
</div>
</div>
</section>
<section id="table-2.11" class="level2">
<h2 class="anchored" data-anchor-id="table-2.11">Table 2.11</h2>
<p>The statsmodels package allows to define linear regression models using a formula definition similar to R. In contrast to R, all variables need to be specified explicitly. We construct a formula excluding the dependent variable and the <code>TAX</code> column</p>
<div id="cell-65" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.416884Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.416445Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.446083Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.445615Z&quot;}" data-scrolled="false" data-execution_count="34">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data loading and preprocessing</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>housing_df <span class="op">=</span> dmba.load_data(<span class="st">'WestRoxbury.csv'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>housing_df.columns <span class="op">=</span> [s.strip().replace(<span class="st">' '</span>, <span class="st">'_'</span>) <span class="cf">for</span> s <span class="kw">in</span> housing_df.columns]</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>housing_df <span class="op">=</span> pd.get_dummies(housing_df, prefix_sep<span class="op">=</span><span class="st">'_'</span>, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>excludeColumns <span class="op">=</span> (<span class="st">'TOTAL_VALUE'</span>, <span class="st">'TAX'</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>predictors <span class="op">=</span> [s <span class="cf">for</span> s <span class="kw">in</span> housing_df.columns <span class="cf">if</span> s <span class="kw">not</span> <span class="kw">in</span> excludeColumns]</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>outcome <span class="op">=</span> <span class="st">'TOTAL_VALUE'</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co"># partition data</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> housing_df[predictors]</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> housing_df[outcome]</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>train_X, valid_X, train_y, valid_y <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.4</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression()</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>model.fit(train_X, train_y)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>train_pred <span class="op">=</span> model.predict(train_X)</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>train_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TOTAL_VALUE'</span>: train_y, </span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'predicted'</span>: train_pred, </span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'residual'</span>: train_y <span class="op">-</span> train_pred</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_results.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      TOTAL_VALUE   predicted   residual
2024        392.0  387.726258   4.273742
5140        476.3  430.785540  45.514460
5259        367.4  384.042952 -16.642952
421         350.3  369.005551 -18.705551
1401        348.1  314.725722  33.374278</code></pre>
</div>
</div>
<div id="cell-66" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.460990Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.460339Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.509681Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.510062Z&quot;}" data-execution_count="35">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>plt.plot(train_results.TOTAL_VALUE, train_results.predicted, <span class="st">'.'</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'actual'</span>)  <span class="co"># set x-axis label</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'predicted'</span>)  <span class="co"># set y-axis label</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> plt.gca()</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>plt.plot(axes.get_xlim(), axes.get_xlim(), <span class="st">'--'</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Predict the validation data</p>
<div id="cell-68" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.512363Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.511971Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.521601Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.522091Z&quot;}" data-execution_count="36">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>valid_pred <span class="op">=</span> model.predict(valid_X)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>valid_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TOTAL_VALUE'</span>: valid_y, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'predicted'</span>: valid_pred, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'residual'</span>: valid_y <span class="op">-</span> valid_pred</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(valid_results.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      TOTAL_VALUE   predicted   residual
1822        462.0  406.946377  55.053623
1998        370.4  362.888928   7.511072
5126        407.4  390.287208  17.112792
808         316.1  382.470203 -66.370203
4034        393.2  434.334998 -41.134998</code></pre>
</div>
</div>
<div id="cell-69" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.524579Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.524086Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.557436Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.557750Z&quot;}" data-execution_count="37">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>plt.plot(valid_results.TOTAL_VALUE, valid_results.predicted, <span class="st">'.'</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'actual'</span>)  <span class="co"># set x-axis label</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'predicted'</span>)  <span class="co"># set y-axis label</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> plt.gca()</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>plt.plot(axes.get_xlim(), axes.get_xlim(), <span class="st">'--'</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="table-2.13" class="level2">
<h2 class="anchored" data-anchor-id="table-2.13">Table 2.13</h2>
<p>We can use the metrics that scikit-learn provides.</p>
<div id="cell-71" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.560087Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.559667Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.564259Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.564629Z&quot;}" data-execution_count="38">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Training set r2: '</span>, r2_score(train_results.TOTAL_VALUE, train_results.predicted))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Validation set r2: '</span>, r2_score(valid_results.TOTAL_VALUE, valid_results.predicted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training set r2:  0.8097361461091853
Validation set r2:  0.8171327286147876</code></pre>
</div>
</div>
<div id="cell-72" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.566763Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.566348Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.574185Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.574564Z&quot;}" data-execution_count="39">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import the utility function regressionSummary</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dmba <span class="im">import</span> regressionSummary</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># training set</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>regressionSummary(train_results.TOTAL_VALUE, train_results.predicted)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># validation set</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>regressionSummary(valid_results.TOTAL_VALUE, valid_results.predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression statistics

                      Mean Error (ME) : 0.0000
       Root Mean Squared Error (RMSE) : 43.0306
            Mean Absolute Error (MAE) : 32.6042
          Mean Percentage Error (MPE) : -1.1116
Mean Absolute Percentage Error (MAPE) : 8.4886

Regression statistics

                      Mean Error (ME) : -0.1463
       Root Mean Squared Error (RMSE) : 42.7292
            Mean Absolute Error (MAE) : 31.9663
          Mean Percentage Error (MPE) : -1.0884
Mean Absolute Percentage Error (MAPE) : 8.3283</code></pre>
</div>
</div>
</section>
<section id="table-2.14" class="level2">
<h2 class="anchored" data-anchor-id="table-2.14">Table 2.14</h2>
<div id="cell-74" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.576733Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.576355Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.587980Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.588474Z&quot;}" data-execution_count="40">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LOT_SQFT'</span>: [<span class="dv">4200</span>, <span class="dv">6444</span>, <span class="dv">5035</span>],</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'YR_BUILT'</span>: [<span class="dv">1960</span>, <span class="dv">1940</span>, <span class="dv">1925</span>],</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GROSS_AREA'</span>: [<span class="dv">2670</span>, <span class="dv">2886</span>, <span class="dv">3264</span>],</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'LIVING_AREA'</span>: [<span class="dv">1710</span>, <span class="dv">1474</span>, <span class="dv">1523</span>],</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FLOORS'</span>: [<span class="fl">2.0</span>, <span class="fl">1.5</span>, <span class="fl">1.9</span>],</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ROOMS'</span>: [<span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">6</span>],</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'BEDROOMS'</span>: [<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>],</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FULL_BATH'</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'HALF_BATH'</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'KITCHEN'</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'FIREPLACE'</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'REMODEL_Old'</span>: [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'REMODEL_Recent'</span>: [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_data)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Predictions: '</span>, model.predict(new_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   LOT_SQFT  YR_BUILT  GROSS_AREA  LIVING_AREA  FLOORS  ROOMS  BEDROOMS  \
0      4200      1960        2670         1710     2.0     10         4   
1      6444      1940        2886         1474     1.5      6         3   
2      5035      1925        3264         1523     1.9      6         2   

   FULL_BATH  HALF_BATH  KITCHEN  FIREPLACE  REMODEL_Old  REMODEL_Recent  
0          1          1        1          1            0               0  
1          1          1        1          1            0               0  
2          1          0        1          0            0               1  
Predictions:  [384.47210285 378.06696706 386.01773842]</code></pre>
</div>
</div>
</section>
<section id="figure-2.2-and-2.3" class="level2">
<h2 class="anchored" data-anchor-id="figure-2.2-and-2.3">Figure 2.2 and 2.3</h2>
<div id="cell-77" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.591176Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.590574Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.597291Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.597635Z&quot;}" data-execution_count="41">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'Expenditure'</span>: [<span class="dv">239</span>, <span class="dv">364</span>,<span class="dv">602</span>, <span class="dv">644</span>, <span class="dv">770</span>, <span class="dv">789</span>, <span class="dv">911</span>], </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'Revenue'</span>: [<span class="dv">514</span>, <span class="dv">789</span>, <span class="dv">550</span>, <span class="dv">1386</span>, <span class="dv">1394</span>, <span class="dv">1440</span>, <span class="dv">1354</span>]})</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Expenditure</th>
<th data-quarto-table-cell-role="th">Revenue</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>239</td>
<td>514</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>364</td>
<td>789</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>602</td>
<td>550</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>644</td>
<td>1386</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>770</td>
<td>1394</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>789</td>
<td>1440</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>911</td>
<td>1354</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-78" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.600169Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.599596Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.736610Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.735775Z&quot;}" data-execution_count="42">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df.plot.scatter(x<span class="op">=</span><span class="st">'Expenditure'</span>, y<span class="op">=</span><span class="st">'Revenue'</span>, xlim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1000</span>), ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1600</span>), figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">3.5</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Increase the separation between the plots</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-79" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.742260Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.741862Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.744870Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.745213Z&quot;}" data-execution_count="43">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">list</span>(df.Expenditure)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="bu">list</span>(df.Revenue)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> interpolate</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> interpolate.PchipInterpolator(x, y)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>x_new <span class="op">=</span> np.linspace(x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>], <span class="dv">100</span>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>y_new <span class="op">=</span> [f(xi) <span class="cf">for</span> xi <span class="kw">in</span> x_new]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-80" class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2021-05-27T20:01:24.763992Z&quot;,&quot;iopub.status.busy&quot;:&quot;2021-05-27T20:01:24.756412Z&quot;,&quot;iopub.status.idle&quot;:&quot;2021-05-27T20:01:24.881476Z&quot;,&quot;shell.execute_reply&quot;:&quot;2021-05-27T20:01:24.881918Z&quot;}" data-scrolled="true" data-execution_count="44">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>df.plot.scatter(x<span class="op">=</span><span class="st">'Expenditure'</span>, y<span class="op">=</span><span class="st">'Revenue'</span>, xlim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1000</span>), ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1600</span>), figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">3.5</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x_new, y_new)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Increase the separation between the plots</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>